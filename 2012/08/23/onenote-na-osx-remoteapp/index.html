
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>OneNote na OSX - RemoteApp - itoutline.me</title>
  <meta name="author" content="itoutline.me">

  
  <meta name="description" content="Rozszerzenie funkcjonalności RDP o RemoteApp jest bardzo fajnym pomysłem. Nie potrzebuje całego pulpitu Windowsa a tylko dostępu do maksymalnie kilku &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://itoutline.me/2012/08/23/onenote-na-osx-remoteapp/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="itoutline.me" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!-- Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href='https://fonts.googleapis.com/css?family=Lato' rel='stylesheet' type='text/css'>
<link href="/stylesheets/data-table.css" media="screen, projection" rel="stylesheet" type="text/css" />
<link href="/stylesheets/keys.css" rel="stylesheet" type="text/css" />
<link href='https://fonts.googleapis.com/css?family=Ubuntu:400,700' rel='stylesheet' type='text/css'>

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-34734923-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">itoutline.me</a></h1>
  
    <h2>&nbsp;</h2>
  
  <meta name="google-translate-customization" content="e81cdd0ed4c87a5-36a8c112e17b44b8-g4197450913b80893-c"></meta>
  <script type="text/javascript">
function googleTranslateElementInit() {
      new google.translate.TranslateElement({pageLanguage: 'pl', multilanguagePage: true, autoDisplay: false}, 'google_translate_element');
}
  </script>
  <script type="text/javascript" src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="sitesearch" value="itoutline.me">
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
   
	
    <h1 class="entry-title">OneNote na OSX - RemoteApp</h1>
	
 
    
      <p class="meta">
        




<time class='entry-date' datetime='2012-08-23T14:52:23+00:00'><span class='date'><span class='date-month'>Aug</span> <span class='date-day'>23</span><span class='date-suffix'>rd</span>, <span class='date-year'>2012</span></span> <span class='time'>2:52 pm</span></time>
        
      </p>
    
  </header>


<div class="entry-content"><p>Rozszerzenie funkcjonalności RDP o RemoteApp jest bardzo fajnym pomysłem. Nie potrzebuje całego pulpitu Windowsa a tylko dostępu do maksymalnie kilku aplikacji, których nie ma na osx. Jedną z takich aplikacji MS jest OneNote, powoli tracę nadzieję, że kiedykolwiek się pojawi wersja osx. Testowałem różne rozwiązania EverNote, Springpad, Google Notebook (już zamknięty) i jednak OneNote najbardziej mi odpowiada. W sumie gdyby MS aktualizował swojego klienta RDP to już niczego więcej od tej firmy bym nie oczekiwał jeśli chodzi o osx. Mam dostęp do serwera MS, który działa sobie 24h na nim zainstalował bym to czego mi brakuje i voilà.</p>

<p>Póki co trzeba sobie radzić inaczej. Dzięki <a href="http://www.freerdp.com">freerdp</a> można już korzystać z RemoteApp na osx. Oczywiście nie jest tak kolorowo jakbym chciał ponieważ freerdp korzysta z X11 i &ldquo;wszystkich jego dobrodziejstw&rdquo; ale widoki są.</p>

<h3>Instalacja freerdp</h3>

<p><code>brew install freerdp</code></p>

<p>Wydaje mi się, że jest mały bug w tej recepturze ponieważ o ile freerdp się instaluje to nie działało mapowanie dysków:</p>

<p><img src="/images/freerdp01.png"></p>

<p><code>freerdp_load_library_symbol: failed to open /usr/local/Cellar/freerdp/1.0.1/lib/freerdp/rdpdr: dlopen(/usr/local/Cellar/freerdp/1.0.1/lib/freerdp/rdpdr, 5): image not found</code></p>

<p>Problem rozwiązałem tworząc linki symboliczne w katalogu <code>/usr/local/Cellar/freerdp/1.0.1/lib/freerdp/</code>.</p>

<p><code>cd /usr/local/Cellar/freerdp/1.0.1/lib/freerdp/  
for i in *; do ln -s $i "${i%.*}"; done</code></p>

<p><img src="/images/freerdp02.png"></p>

<p>Po tej operacji nie było już kłopotu z tym poleceniem:</p>

<p><code>xfreerdp -u norbert -g 1440x800 --plugin cliprdr --plugin rdpdr --data disk:HDD:$HOME -- 192.168.1.1:9800</code></p>

<p>Kilka słów wyjaśnienia odnośnie tych niekoniecznie oczywistych parametrów xfreerdp:</p>

<p><code>--plugin cliprdr</code> - powoduje, że działa funkcjonalność schowka<br/>
<code>--plugin rdpdr --data disk:HDD:$HOME</code> - odpowiada za przekierowanie lokalnego dysku, HDD to nazwa dysku/partycji który chcemy przekierowywać (u mnie np. partycja z osx nazywa się HDD), $HOME to katalog który chcemy przekierować, jeśli cały filesystem to można użyć /`</p>

<p>Na razie to tylko uruchomienie zwykłego klienta rdp który wyświetli cały pulpit zdalnej maszyny. Działa całkiem przyzwoicie, CoRD np. ostatnio ma problem z gubieniem wskaźnika myszy po wprowadzeniu tekstu co jest nieco uciążliwe.</p>

<h3>RemoteAPP</h3>

<p>Funkcjonalność ta zadziała na XP, Vista, 7 Ultimate i Enterprise, 2008. Windows 2008 ma natywne narzędzia do wystawiania aplikacji w trybie RemoteApp. W przypadku pozostałych systemów można skorzystać z prostego narzędzia do modyfikacji rejestru</p>

<p><a href="https://sites.google.com/site/kimknight/remoteapptool">https://sites.google.com/site/kimknight/remoteapptool</a></p>

<p><img src="/images/freerdp03.png"></p>

<p>albo zaimportować poniższy plik onenote.reg, który jest poprawny dla standardowej instalacji OneNote 2010:</p>

<pre><code>Windows Registry Editor Version 5.00

[HKEY_LOCAL_MACHINESOFTWAREMicrosoftWindows NTCurrentVersionTerminal ServerTSAppAllowList]
"fDisabledAllowList"=dword:00000001

[HKEY_LOCAL_MACHINESOFTWAREMicrosoftWindows NTCurrentVersionTerminal ServerTSAppAllowListApplicationsONENOTE]
"CommandLineSetting"=dword:00000000
"RequiredCommandLine"=""
"IconIndex"=dword:00000000
"IconPath"="%SYSTEMDRIVE%\Program Files (x86)\Microsoft Office\Office14\ONENOTE.EXE"
"Path"="C:\Program Files (x86)\Microsoft Office\Office14\ONENOTE.EXE"
"ShortPath"="C:\PROGRA~2\MICROS~1\Office14\ONENOTE.EXE"
"VPath"="%SYSTEMDRIVE%\Program Files (x86)\Microsoft Office\Office14\ONENOTE.EXE"
"ShowInTSWA"=dword:00000001
"Name"="Microsoft OneNote 2010"
"SecurityDescriptor"=""
</code></pre>

<p>Podłączenie do OneNote w trybie RemoteApp wygląda tak:</p>

<p><code>xfreerdp -u norbert -g 800x800  --app --plugin rail --data "||onenote" -- 192.168.1.1:9800</code></p>

<p><img src="/images/freerdp04.png"></p>

<p>Idealnie nie jest, nie działa schowek (mam nadzieje, że na razie, w trybie pulpitu nie ma z nim problemu) czyli coś podstawowego przy robieniu notatek. Zwinięcie okna spowoduje, że rozwinie się już tylko białe okienko bez śladu OneNote. Mam jednak nadzieje, że freerdp będzie rozwijane bo widać potencjał w RDP.</p>
</div>





  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">itoutline</span></span>

      




<time class='entry-date' datetime='2012-08-23T14:52:23+00:00'><span class='date'><span class='date-month'>Aug</span> <span class='date-day'>23</span><span class='date-suffix'>rd</span>, <span class='date-year'>2012</span></span> <span class='time'>2:52 pm</span></time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/mountain-lion/'>mountain lion</a>, <a class='category' href='/blog/categories/osx/'>osx</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="http://itoutline.me/2012/08/23/onenote-na-osx-remoteapp/" data-via="" data-counturl="http://itoutline.me/2012/08/23/onenote-na-osx-remoteapp/" >Tweet</a>
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/2012/08/21/cowsay-fortune/" title="Previous Post: Cowsay fortune">&laquo; Cowsay fortune</a>
      
      
        <a class="basic-alignment right" href="/2012/09/07/qemu/" title="Next Post: Qemu">Qemu &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/2018/05/05/Ubuntu-18-04/">WSL - Ubuntu 18.04 - xfce4-terminal</a>
      </li>
    
      <li class="post">
        <a href="/2017/12/01/Unraid-part-1/">Home Cloud</a>
      </li>
    
      <li class="post">
        <a href="/2016/09/27/the-cuttle/">The Cuttle - Boldport Club</a>
      </li>
    
      <li class="post">
        <a href="/2016/05/27/picocom-na-cygwin-slash-windows10/">Picocom na Cygwin/Windows10</a>
      </li>
    
      <li class="post">
        <a href="/2015/10/18/iptables-i-dynamiczne-ip/">Iptables i dynamiczne IP</a>
      </li>
    
  </ul>
</section>




<section>
  <h1>Tag Cloud</h1>
    <span id="tag-cloud"><a href='/blog/categories/android' style='font-size: 103.15789473684211%'>android</a> <a href='/blog/categories/arduino' style='font-size: 103.15789473684211%'>arduino</a> <a href='/blog/categories/curiosities' style='font-size: 103.15789473684211%'>curiosities</a> <a href='/blog/categories/electronics' style='font-size: 106.3157894736842%'>electronics</a> <a href='/blog/categories/linux' style='font-size: 122.10526315789474%'>linux</a> <a href='/blog/categories/mavericks' style='font-size: 103.15789473684211%'>mavericks</a> <a href='/blog/categories/mountain-lion' style='font-size: 141.05263157894737%'>mountain lion</a> <a href='/blog/categories/netflix' style='font-size: 103.15789473684211%'>netflix</a> <a href='/blog/categories/openwrt' style='font-size: 103.15789473684211%'>openwrt</a> <a href='/blog/categories/osx' style='font-size: 160.0%'>osx</a> <a href='/blog/categories/raspberry-pi' style='font-size: 109.47368421052632%'>raspberry pi</a> <a href='/blog/categories/shell' style='font-size: 103.15789473684211%'>shell</a> <a href='/blog/categories/terminal' style='font-size: 103.15789473684211%'>terminal</a> <a href='/blog/categories/tips' style='font-size: 106.3157894736842%'>tips</a> <a href='/blog/categories/unraid' style='font-size: 103.15789473684211%'>unraid</a> <a href='/blog/categories/windows' style='font-size: 109.47368421052632%'>windows</a> <a href='/blog/categories/wsl' style='font-size: 103.15789473684211%'>wsl</a> <a href='/blog/categories/xbmc' style='font-size: 103.15789473684211%'>xbmc</a> <a href='/blog/categories/yosemite' style='font-size: 103.15789473684211%'>yosemite</a> </span>
</section>

<section>

    <p></p>
<span id="google_translate_element"></span>

</section>

  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2018 - itoutline.me -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'itoutlineme';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://itoutline.me/2012/08/23/onenote-na-osx-remoteapp/';
        var disqus_url = 'http://itoutline.me/2012/08/23/onenote-na-osx-remoteapp/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>




<script type="text/javascript">

  var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-34734923-1']);
      _gaq.push(['_trackPageview']);

        (function() {
	     var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
	         ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		     var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		       })();

</script>


</body>
</html>
